<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Papan LED</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #000;
      color: #fff;
    }
    .container {
      max-width: 1600px;
      margin: 0 auto;
      background: #111;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
      position: relative;
      overflow: hidden;
    }

    /* ì—´ ë„ˆë¹„ ë™ì¼í•˜ê²Œ ì„¤ì • */
    th:nth-child(1), td:nth-child(1) { width: 25%; }
    th:nth-child(2), td:nth-child(2) { width: 25%; }
    th:nth-child(3), td:nth-child(3) { width: 25%; }
    th:nth-child(4), td:nth-child(4) { width: 25%; }

    .main-header {
      background: #000;
      padding: 8px 0;
      margin-bottom: 20px;
      border-bottom: 2px solid #0ff;
    }

    .main-header th {
      color: #0ff;
      font-size: 28px;
      font-weight: 900; /* í—¤ë” í°íŠ¸ êµµê²Œ */
      text-shadow: 0 0 15px #0ff;
      background: none;
      padding: 10px;
    }

    /* ë°ì´í„° ì˜ì—­ */
    .data-section {
      margin-top: 20px;
    }

    /* ìŠ¤í¬ë¡¤ ì˜ì—­ */
    .scroll-container {
      height: 400px;
      overflow: hidden;
      position: relative;
    }

    .data-container {
      position: relative;
      overflow: hidden;
    }

    .scroll-wrapper {
      animation: scrollUp 60s linear infinite;
      position: relative;
    }

    .scroll-wrapper:hover {
      animation-play-state: paused;
    }

    @keyframes scrollUp {
      0% { transform: translateY(0); }
      100% { transform: translateY(-50%); }
    }

    table {
      border-collapse: separate;
      border-spacing: 0 12px;
      background-color: #000;
      border-radius: 10px;
      width: 100%;
      table-layout: fixed;
    }

    td {
      padding: 20px 10px;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 24px;
      color: #fff;
      text-shadow: 0 0 5px #fff;
    }

    /* ìˆœìœ„ë³„ ìŠ¤íƒ€ì¼ */
    .rank-1 td { 
      font-size: 36px !important;
      color: #ff00ff !important; /* í•‘í¬ìƒ‰ í˜•ê´‘ìœ¼ë¡œ ë³€ê²½ */
      text-shadow: 0 0 10px #ff00ff, 0 0 20px #ff00ff, 0 0 30px #ff00ff;
      background: rgba(255, 0, 255, 0.1);
    }

    /* 2-4ë“± í˜•ê´‘ìƒ‰ ìŠ¤íƒ€ì¼ */
    .rank-2 td, .rank-3 td, .rank-4 td { 
      font-size: 32px !important;
      color: #00ff00 !important;
      text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00, 0 0 30px #00ff00;
      background: rgba(0, 255, 0, 0.1);
    }

    .rank-5 td { 
      font-size: 28px !important;
      color: #ff69b4 !important;
      text-shadow: 0 0 10px #ff69b4, 0 0 20px #ff69b4;
      background: rgba(255, 105, 180, 0.1);
    }

    .loading {
      color: #666;
      text-align: center;
      padding: 20px;
      font-size: 24px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- ë©”ì¸ í—¤ë” -->
    <div class="main-header">
      <table>
        <tr>
          <th>RANK</th>
          <th>Tim</th>
          <th>Nama</th>
          <th>Jumlahnya</th>
        </tr>
      </table>
    </div>

    <!-- ë°ì´í„° ì„¹ì…˜ -->
    <div class="data-section">
      <!-- ìƒìœ„ 5ë“± -->
      <table id="topRanks">
        <tbody id="topRanksBody">
          <!-- ìƒìœ„ 5ë“± ë°ì´í„° -->
        </tbody>
      </table>

      <!-- 6ë“± ì´í›„ ìŠ¤í¬ë¡¤ -->
      <div class="scroll-container">
        <div class="data-container">
          <div class="scroll-wrapper">
            <table id="rankTable">
              <tbody id="rankDisplays">
                <tr>
                  <td class="loading" colspan="4">Memuat data...</td>
                </tr>
              </tbody>
            </table>
            <table id="rankTableClone">
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const SHEET_URL = 'https://script.google.com/macros/s/AKfycbziiiibisHWj9M0f_jAxuxMbNsGIBOOFUNHBaAg2g46wryERUfO2sbeKvfGs3kL3XHsdA/exec';
    const DISPLAY_COLUMNS = [2, 3, 4, 5];
    const rankEmojis = {
      1: 'ğŸ‘‘ ğŸ†',
      2: 'ğŸ¥ˆ',
      3: 'ğŸ¥‰',
      4: 'âœ¨',
      5: 'ğŸ”¥ âš¡'
    };

    function createDataRow(rowData) {
      const tr = document.createElement('tr');
      const rank = parseInt(rowData[2]) || 0;
      tr.className = rank <= 5 ? `rank-${rank}` : '';
      
      DISPLAY_COLUMNS.forEach((index, colIndex) => {
        const td = document.createElement('td');
        let content = rowData[index] || '';
        
        if (colIndex === 0 && rankEmojis[rank]) {
          content += ` ${rankEmojis[rank]}`;
        }
        
        td.innerHTML = content;
        tr.appendChild(td);
      });
      
      return tr;
    }

    async function updateData() {
      try {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
        const response = await fetch(SHEET_URL);
        const data = await response.json();
        
        if (data && data.data && data.data.length > 0) {
          const tableData = data.data.slice(2);

          // ìƒìœ„ 5ë“± í‘œì‹œ
          const topRanksBody = document.getElementById('topRanksBody');
          topRanksBody.innerHTML = '';
          tableData.slice(0, 5).forEach(rowData => {
            topRanksBody.appendChild(createDataRow(rowData));
          });Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 

          // 6ë“± ì´í›„ ìˆœí™˜ í‘œì‹œ
          const rankDisplays = document.getElementById('rankDisplays');
          rankDisplays.innerHTML = '';
          tableData.slice(5).forEach(rowData => {
            rankDisplays.appendChild(createDataRow(rowData));
          });Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 

          const rankTableClone = document.getElementById('rankTableClone');
          rankTableClone.innerHTML = rankDisplays.innerHTML;
        }
      } catch (error) {
        console.error('ë°ì´í„° ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
      }
    }

    // ì´ˆê¸° ë°ì´í„° ë¡œë“œ ë° ì£¼ê¸°ì  ì—…ë°ì´íŠ¸
    updateData();Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
    setInterval(updateData, 30000); // 30ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
  </script>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
</body>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
</html>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
