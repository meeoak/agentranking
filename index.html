<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>LED ì „ê´‘íŒ</title>
  <style>
    /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ ìœ ì§€ */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #000;
      color: #fff;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: #111;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
      position: relative;
      overflow: hidden;
    }

    /* ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆ */
    .scroll-container {
      height: 600px;
      overflow: hidden;
      position: relative;
    }

    #rankTable {
      width: 100%;
      position: relative;
    }

    /* ìŠ¤í¬ë¡¤ ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•œ wrapper - ì†ë„ ì¡°ì ˆ */
    .scroll-wrapper {
      animation: scrollUp 40s linear infinite; /* 40ì´ˆë¡œ ë³€ê²½ */
      position: relative;
    }

    .scroll-wrapper:hover {
      animation-play-state: paused;
    }

    @keyframes scrollUp {
      0% {
        transform: translateY(0);
      }
      100% {
        transform: translateY(-50%);
      }
    }

    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 8px;
      background-color: #000;
      border-radius: 10px;
    }

    /* ë‚˜ë¨¸ì§€ ìŠ¤íƒ€ì¼ì€ ë™ì¼í•˜ê²Œ ìœ ì§€ */
    th {
      background-color: #222;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      color: #0ff;
      text-shadow: 0 0 10px #0ff;
      position: sticky;
      top: 0;
      z-index: 1;
    }

    td {
      padding: 15px;
      text-align: center;
      font-size: 16px;
      background: #111;
    }

    .led-text {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      text-shadow: 0 0 5px currentColor, 0 0 10px currentColor, 0 0 20px currentColor;
    }

    /* ìˆœìœ„ë³„ ìŠ¤íƒ€ì¼ */
    .rank-1 .name-column { 
      font-size: 38px !important; 
      color: #ff0;
      text-shadow: 0 0 10px #ff0, 0 0 20px #ff0, 0 0 30px #ff0;
      animation: ledPulse1 1.5s infinite;
    }
    .rank-2 .name-column { 
      font-size: 34px !important; 
      color: #0ff;
      text-shadow: 0 0 10px #0ff, 0 0 20px #0ff;
      animation: ledPulse2 1.8s infinite;
    }
    .rank-3 .name-column { 
      font-size: 30px !important; 
      color: #f0f;
      text-shadow: 0 0 10px #f0f, 0 0 20px #f0f;
      animation: ledPulse3 2s infinite;
    }
    .rank-4 .name-column { 
      font-size: 28px !important; 
      color: #0f0;
      text-shadow: 0 0 10px #0f0;
      animation: ledPulse4 2.2s infinite;
    }
    .rank-5 .name-column { 
      font-size: 26px !important; 
      color: #f00;
      text-shadow: 0 0 10px #f00;
      animation: ledPulse5 2.5s infinite;
    }

    /* LED ì• ë‹ˆë©”ì´ì…˜ */
    @keyframes ledPulse1 {
      0%, 100% { opacity: 1; text-shadow: 0 0 10px #ff0, 0 0 20px #ff0, 0 0 30px #ff0; }
      50% { opacity: 0.8; text-shadow: 0 0 15px #ff0, 0 0 25px #ff0, 0 0 35px #ff0; }
    }
    @keyframes ledPulse2 {
      0%, 100% { opacity: 1; text-shadow: 0 0 10px #0ff, 0 0 20px #0ff; }
      50% { opacity: 0.8; text-shadow: 0 0 15px #0ff, 0 0 25px #0ff; }
    }
    @keyframes ledPulse3 {
      0%, 100% { opacity: 1; text-shadow: 0 0 10px #f0f, 0 0 20px #f0f; }
      50% { opacity: 0.8; text-shadow: 0 0 15px #f0f, 0 0 25px #f0f; }
    }
    @keyframes ledPulse4 {
      0%, 100% { opacity: 1; text-shadow: 0 0 10px #0f0; }
      50% { opacity: 0.8; text-shadow: 0 0 15px #0f0; }
    }
    @keyframes ledPulse5 {
      0%, 100% { opacity: 1; text-shadow: 0 0 10px #f00; }
      50% { opacity: 0.8; text-shadow: 0 0 15px #f00; }
    }

    .rank-emoji {
      font-size: 24px;
      margin-left: 8px;
      text-shadow: none;
      animation: emojiFloat 2s ease-in-out infinite;
    }

    @keyframes emojiFloat {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }

    #lastUpdate {
      color: #666;
      text-align: right;
      margin-top: 20px;
      font-size: 14px;
      text-shadow: 0 0 5px #666;
    }

    /* ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤ì„ ìœ„í•œ ì¶”ê°€ ìŠ¤íƒ€ì¼ */
    .scroll-wrapper {
      transition: transform 0.5s ease-out;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="scroll-container">
      <div class="scroll-wrapper">
        <table id="rankTable">
          <thead id="tableHeader">
          </thead>
          <tbody id="rankDisplays">
            <tr>
              <td class="loading">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</td>
            </tr>
          </tbody>
        </table>
        <!-- ë³µì œëœ í…Œì´ë¸” (ìˆœí™˜ íš¨ê³¼ë¥¼ ìœ„í•´) -->
        <table id="rankTableClone">
        </table>
      </div>
    </div>
    <div id="lastUpdate"></div>
  </div>

  <script>
    const SHEET_URL = 'https://script.google.com/macros/s/AKfycbziiiibisHWj9M0f_jAxuxMbNsGIBOOFUNHBaAg2g46wryERUfO2sbeKvfGs3kL3XHsdA/exec';

    const rankEmojis = {
      1: 'ğŸ‘‘ ğŸ† ğŸ¥‡',
      2: 'ğŸ¥ˆ â­ âœ¨',
      3: 'ğŸ¥‰ ğŸŒŸ âš¡',
      4: 'ğŸ’« ğŸŒ  ğŸ’ª',
      5: 'âœ¨ ğŸ¯ ğŸ”¥'
    };

    function createHeaderRow(headerData) {
      const headerRow = document.createElement('tr');
      headerData.forEach((header, index) => {
        if (index !== 1) {
          const th = document.createElement('th');
          th.textContent = header;
          th.className = 'led-text';
          headerRow.appendChild(th);
        }
      });
      return headerRow;
    }

    function createDataRows(data) {
      return data.map(rowData => {
        const rank = parseInt(rowData[2]);
        const team = rowData[1];
        
        const tr = document.createElement('tr');
        tr.className = `team-${team}${rank <= 10 ? ` rank-${rank}` : ''}`;
        
        rowData.forEach((cellData, index) => {
          if (index !== 1) {
            const td = document.createElement('td');
            if (index === 2) {
              const rankNumber = parseInt(cellData);
              td.innerHTML = cellData + (rankEmojis[rankNumber] ? 
                `<span class="rank-emoji">${rankEmojis[rankNumber]}</span>` : '');
              td.className = 'rank-column led-text';
            } else if (index === 0) {
              td.textContent = cellData || '';
              td.className = 'name-column led-text';
            } else {
              td.textContent = cellData || '';
              td.className = 'led-text';
            }
            tr.appendChild(td);
          }
        });
        
        return tr;
      });
    }

    async function updateData() {
      try {
        const response = await fetch(SHEET_URL);
        const data = await response.json();
        
        if (data && data.data && data.data.length > 0) {
          const headerData = data.data[0];
          const tableData = data.data.slice(1);
          
          // ì›ë³¸ í…Œì´ë¸” ì—…ë°ì´íŠ¸
          const tableHeader = document.getElementById('tableHeader');
          tableHeader.innerHTML = '';
          tableHeader.appendChild(createHeaderRow(headerData));
          
          const rankDisplays = document.getElementById('rankDisplays');
          rankDisplays.innerHTML = '';
          createDataRows(tableData).forEach(row => rankDisplays.appendChild(row));

          // ë³µì œ í…Œì´ë¸” ì—…ë°ì´íŠ¸
          const rankTableClone = document.getElementById('rankTableClone');
          rankTableClone.innerHTML = '';
          const cloneHeader = createHeaderRow(headerData);
          rankTableClone.appendChild(cloneHeader);
          const cloneBody = document.createElement('tbody');
          createDataRows(tableData).forEach(row => cloneBody.appendChild(row.cloneNode(true)));
          rankTableClone.appendChild(cloneBody);
          
          const now = new Date();
          document.getElementById('lastUpdate').textContent = 
            `ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${now.toLocaleString()}`;

          // ìŠ¤í¬ë¡¤ ì• ë‹ˆë©”ì´ì…˜ ì¬ì‹œì‘
          const wrapper = document.querySelector('.scroll-wrapper');
          wrapper.style.animation = 'none';
          wrapper.offsetHeight; // ë¦¬í”Œë¡œìš° ê°•ì œ
          wrapper.style.animation = 'scrollUp 40s linear infinite'; // 40ì´ˆë¡œ ë³€ê²½
        }
      } catch (error) {
        console.error('Error fetching data:', error);
        document.getElementById('rankDisplays').innerHTML = 
          '<tr><td class="loading">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</td></tr>';
      }
    }

    updateData();
    setInterval(updateData, 30000);
  </script>
</body>
</html>
